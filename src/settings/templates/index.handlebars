{{>partials_head}}
<body>
  <div id="layout">
    {{>partials_topbar}}

    <div style="padding: 1em 0.5em 0 0.5em;">
      <h2>Accounts</h2>
      <div>
        {{#each account.oauths}}
            <div class="preset-row">
              <span style="padding-right: 0.2em;">
                <span class="icon-group">
                  {{#if (eq service "slack")}}
                    <img
                      src="{{profile.image_72}}"
                      {{#if profile.display_name}}
                        alt="{{profile.display_name}} ({{team.name}})"
                      {{else}}
                        alt="{{profile.real_name}} ({{team.name}})"
                      {{/if}}
                    >
                    {{#unless team.icon.image_default}}
                      <img
                        src="{{team.icon.image_44}}"
                        alt="{{team.name}}"
                        class="team-icon"
                      >
                    {{/unless}}
                  {{/if}}
                  {{#if (eq service "github")}}
                    <img
                      src="{{profile.image_72}}"
                      {{#if profile.name}}
                        alt="{{profile.name}}"
                      {{else}}
                        alt="{{profile.login}}"
                      {{/if}}
                    >
                    <img
                      src="https://github.githubassets.com/apple-touch-icon.png"
                      class="team-icon"
                    >
                  {{/if}}
                </span>
              </span>
              <strong>
                {{#if (eq service "slack")}}
                  {{#if profile.display_name}}
                    {{profile.display_name}}
                  {{else}}
                    {{profile.real_name}}
                  {{/if}}
                  {{#if team}}({{team.name}}){{/if}}
                {{/if}}
                {{#if (eq service "github")}}
                  {{#if profile.name}}
                    {{profile.name}}
                  {{else}}
                    {{profile.login}}
                  {{/if}}
                {{/if}}
              </strong>
              <div style="flex-grow: 1"></div>
              <form method="POST" action="{{ route "authUnlink" }}">
                <input type="hidden" name="_csrf" value="{{@csrfToken}}">
                <input type="hidden" name="service" value="{{service}}">
                <input type="hidden" name="oauth_id" value="{{oauth_id}}">
                <button type="submit">unlink</button>
              </form>
            </div>
        {{/each}}
        <div class="preset-row">
          <span style="padding-right: 0.2em;">
            <strong>
              link another account
            </strong>
          </span>
          <div style="flex-grow: 1"></div>
          {{#with slackAuth}}
            <form method="GET" action="https://slack.com/oauth/authorize">
              <input type="hidden" name="client_id" value="{{ client_id }}">
              <input type="hidden" name="redirect_uri" value="{{ absolute "authSlack" }}">
              <input type="hidden" name="state" value="{{ state }}">
              <input type="hidden" name="scope" value="{{ scope }}">
              <button type="submit">slack</button>
            </form>
          {{/with}}
          {{#with githubAuth}}
            <form method="GET" action="https://github.com/login/oauth/authorize">
              <input type="hidden" name="client_id" value="{{ client_id }}">
              <input type="hidden" name="redirect_uri" value="{{ absolute "authGithub" }}">
              <input type="hidden" name="state" value="{{ state }}">
              <input type="hidden" name="scope" value="{{ scope }}">
              <button type="submit">github</button>
            </form>
          {{/with}}
        </div>

        <form method="POST" action="{{ route "authLogout" }}">
          <input type="hidden" name="_csrf" value="{{@csrfToken}}">
          <button type="submit">logout</button>
        </form>
      </div>
    </div>
    {{> partials_footer . }}

  </div>
</body>
